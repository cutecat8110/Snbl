{"version":3,"sources":["webpack:///./src/views/back/Orders.vue","webpack:///./src/components/back/OrderModal.vue","webpack:///./src/components/back/OrderModal.vue?8238","webpack:///./src/views/back/Orders.vue?2aa4"],"names":["class","active","isLoading","z-index","orders","item","key","length","is_paid","$filters","date","create_at","user","email","products","product","i","title","qty","unit","total","type","id","updatePaid","for","openModal","pages","pagination","getOrders","order","tempOrder","ref","delOrder","tabindex","aria-labelledby","aria-hidden","data-bs-backdrop","data-bs-dismiss","aria-label","style","name","tel","address","paid_date","currency","final_total","value","$emit","mixins","modalMixin","emits","props","Object","default","data","status","modal","isPaid","watch","this","render","components","DelModal","Pagination","OrderModal","inject","currentPage","methods","page","url","$http","get","tempProduct","then","res","event","$refs","orderModal","delModal","api","paid","put","hideModal","httpMessageState","delete","created"],"mappings":"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","file":"js/chunk-2d0af0fb.d31c6419.js","sourcesContent":["<template>\n  <div>\n    <Loading :active=\"isLoading\" :z-index=\"1600\"></Loading>\n    <div class=\"container py-4\">\n      <div class=\"bg-white px-4 border\">\n        <div class=\"navbar py-3\">\n          <div class=\"container-fluid\">\n            <span class=\"navbar-brand\">訂單管理</span>\n          </div>\n        </div>\n        <div class=\"table-responsive mb-3\">\n          <table class=\"table table-hover align-middle mb-0\">\n            <thead class=\"bg-gray-000\">\n              <tr>\n                <th class=\"position-relative\">購買時間</th>\n                <th class=\"position-relative\">Email</th>\n                <th class=\"position-relative col-4\">購買款項</th>\n                <th class=\"position-relative\">應付金額</th>\n                <th class=\"position-relative\">是否付款</th>\n                <th class=\"col-1\">編輯</th>\n              </tr>\n            </thead>\n            <tbody>\n              <template v-for=\"(item, key) in orders\" :key=\"key\">\n                <tr v-if=\"orders.length\" :class=\"{ 'text-secondary': !item.is_paid }\">\n                  <td>{{ $filters.date(item.create_at) }}</td>\n                  <td><span v-text=\"item.user.email\" v-if=\"item.user\"></span></td>\n                  <td>\n                    <ul class=\"list-unstyled my-0\">\n                      <li v-for=\"(product, i) in item.products\" :key=\"i\">\n                        {{ product.product.title }} 數量：{{ product.qty }}\n                        {{ product.product.unit }}\n                      </li>\n                    </ul>\n                  </td>\n                  <td class=\"text-end\">{{ item.total }}</td>\n                  <td>\n                    <div class=\"form-check form-switch\">\n                      <input\n                        class=\"form-check-input\"\n                        type=\"checkbox\"\n                        :id=\"`paidSwitch${item.id}`\"\n                        v-model=\"item.is_paid\"\n                        @change=\"updatePaid(item)\"\n                      />\n                      <label class=\"form-check-label\" :for=\"`paidSwitch${item.id}`\">\n                        <span v-if=\"item.is_paid\">已付款</span>\n                        <span v-else>未付款</span>\n                      </label>\n                    </div>\n                  </td>\n                  <td>\n                    <div class=\"btn-group\">\n                      <button\n                        class=\"btn btn-outline-primary btn-sm\"\n                        type=\"button\"\n                        @click=\"openModal('edit', item)\"\n                      >\n                        編輯\n                      </button>\n                      <button\n                        class=\"btn btn-outline-danger btn-sm\"\n                        type=\"button\"\n                        @click=\"openModal('delete', item)\"\n                      >\n                        刪除\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              </template>\n            </tbody>\n          </table>\n        </div>\n        <Pagination :pages=\"pagination\" @emit-page=\"getOrders\"></Pagination>\n      </div>\n    </div>\n    <OrderModal :order=\"tempOrder\" ref=\"orderModal\" @update-paid=\"updatePaid\"></OrderModal>\n    <DelModal ref=\"delModal\" @del-item=\"delOrder\"></DelModal>\n  </div>\n</template>\n\n<script>\nimport DelModal from '@/components/back/DelModal.vue';\nimport OrderModal from '@/components/back/OrderModal.vue';\nimport Pagination from '@/components/back/Pagination.vue';\n\nexport default {\n  components: {\n    DelModal,\n    Pagination,\n    OrderModal,\n  },\n  inject: ['httpMessageState'],\n  data() {\n    return {\n      isLoading: false,\n      pagination: [],\n      currentPage: 1,\n      orders: [],\n      tempOrder: {},\n    };\n  },\n  methods: {\n    getOrders(page = 1) {\n      this.currentPage = page;\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${page}`;\n      this.$http.get(url, this.tempProduct).then((res) => {\n        this.orders = res.data.orders;\n        this.pagination = res.data.pagination;\n        this.isLoading = false;\n      });\n    },\n    openModal(event, item) {\n      this.tempOrder = { ...item };\n      if (event === 'edit') {\n        this.$refs.orderModal.openModal();\n      } else if (event === 'delete') {\n        this.$refs.delModal.openModal();\n      }\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid,\n      };\n      const status = '更新付款狀態';\n      this.$http.put(api, { data: paid }).then((res) => {\n        this.getOrders(this.currentPage);\n        this.isLoading = false;\n        this.$refs.orderModal.hideModal();\n        this.httpMessageState(res, status);\n      });\n    },\n    delOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then(() => {\n        this.getOrders(this.currentPage);\n        this.isLoading = false;\n        this.$refs.delModal.hideModal();\n      });\n    },\n  },\n  created() {\n    this.getOrders();\n  },\n};\n</script>\n","<template>\n  <div\n    id=\"oderModal\"\n    ref=\"modal\"\n    class=\"modal fade\"\n    tabindex=\"-1\"\n    aria-labelledby=\"oderModalLabel\"\n    aria-hidden=\"true\"\n    data-bs-backdrop=\"static\"\n  >\n    <div class=\"modal-dialog modal-xl modal-dialog-scrollable\">\n      <div class=\"modal-content  border-0\">\n        <div class=\"modal-header\">\n          <h3 id=\"exampleModalLabel\" class=\"modal-title\">\n            <span>訂單細節</span>\n          </h3>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"row\">\n            <div class=\"col-md-4\">\n              <h5>用戶資料</h5>\n              <table class=\"table\">\n                <tbody v-if=\"tempOrder.user\">\n                  <tr>\n                    <th style=\"width: 100px\">姓名</th>\n                    <td>{{ tempOrder.user.name }}</td>\n                  </tr>\n                  <tr>\n                    <th>Email</th>\n                    <td>{{ tempOrder.user.email }}</td>\n                  </tr>\n                  <tr>\n                    <th>電話</th>\n                    <td>{{ tempOrder.user.tel }}</td>\n                  </tr>\n                  <tr>\n                    <th>地址</th>\n                    <td>{{ tempOrder.user.address }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            <div class=\"col-md-8\">\n              <h5>訂單細節</h5>\n              <table class=\"table\">\n                <tbody>\n                  <tr>\n                    <th style=\"width: 100px\">訂單編號</th>\n                    <td>{{ tempOrder.id }}</td>\n                  </tr>\n                  <tr>\n                    <th>下單時間</th>\n                    <td>{{ $filters.date(tempOrder.create_at) }}</td>\n                  </tr>\n                  <tr>\n                    <th>付款時間</th>\n                    <td>\n                      <span v-if=\"tempOrder.paid_date\">\n                        {{ $filters.date(tempOrder.paid_date) }}\n                      </span>\n                      <span v-else>時間不正確</span>\n                    </td>\n                  </tr>\n                  <tr>\n                    <th>付款狀態</th>\n                    <td>\n                      <strong v-if=\"tempOrder.is_paid\" class=\"text-success\">已付款</strong>\n                      <span v-else class=\"text-muted\">尚未付款</span>\n                    </td>\n                  </tr>\n                  <tr>\n                    <th>總金額</th>\n                    <td>\n                      {{ $filters.currency(tempOrder.total) }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n              <h5>選購商品</h5>\n              <table class=\"table\">\n                <thead>\n                  <tr></tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"item in tempOrder.products\" :key=\"item.id\">\n                    <th>\n                      {{ item.product.title }}\n                    </th>\n                    <td>{{ item.qty }} / {{ item.product.unit }}</td>\n                    <td class=\"text-end\">\n                      {{ $filters.currency(item.final_total) }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n              <div class=\"d-flex justify-content-end mb-3\">\n                <div class=\"form-check\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"checkbox\"\n                    value=\"\"\n                    id=\"flexCheckDefault\"\n                    v-model=\"tempOrder.is_paid\"\n                  />\n                  <label class=\"form-check-label\" for=\"flexCheckDefault\">\n                    <span v-if=\"tempOrder.is_paid\">已付款</span>\n                    <span v-else>未付款</span>\n                  </label>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-outline-secondary me-3\" data-bs-dismiss=\"modal\">\n            取消\n          </button>\n          <button type=\"button\" class=\"btn btn-primary\" @click=\"$emit('update-paid', tempOrder)\">\n            確認\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport modalMixin from '@/mixins/modalMixin';\n\nexport default {\n  mixins: [modalMixin],\n  emits: ['update-paid'],\n  props: {\n    order: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  data() {\n    return {\n      status: {},\n      modal: '',\n      tempOrder: {},\n      isPaid: false,\n    };\n  },\n  watch: {\n    order() {\n      this.tempOrder = { ...this.order };\n    },\n  },\n};\n</script>\n","import { render } from \"./OrderModal.vue?vue&type=template&id=25f88ac2\"\nimport script from \"./OrderModal.vue?vue&type=script&lang=js\"\nexport * from \"./OrderModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Orders.vue?vue&type=template&id=1e9a1c55\"\nimport script from \"./Orders.vue?vue&type=script&lang=js\"\nexport * from \"./Orders.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}